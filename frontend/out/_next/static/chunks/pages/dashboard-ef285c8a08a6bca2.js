(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{5666:function(){},1075:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return s(6836)}])},3736:function(e,a,s){"use strict";s.d(a,{F$:function(){return c},Q5:function(){return d},qE:function(){return i}});var t=s(5893),r=s(7294),l=s(952),n=s(3161);let i=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.fC,{ref:a,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...r})});i.displayName=l.fC.displayName;let c=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.Ee,{ref:a,className:(0,n.cn)("aspect-square h-full w-full",s),...r})});c.displayName=l.Ee.displayName;let d=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.NY,{ref:a,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...r})});d.displayName=l.NY.displayName},9889:function(e,a,s){"use strict";s.d(a,{Ol:function(){return i},Zb:function(){return n},aY:function(){return d},eW:function(){return u},ll:function(){return c}});var t=s(5893),r=s(7294),l=s(3161);let n=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});n.displayName="Card";let i=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...r})});i.displayName="CardHeader";let c=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("h3",{ref:a,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});c.displayName="CardTitle",r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("p",{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",s),...r})}).displayName="CardDescription";let d=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("p-6 pt-0",s),...r})});d.displayName="CardContent";let u=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("flex items-center p-6 pt-0",s),...r})});u.displayName="CardFooter"},4756:function(){},529:function(e,a,s){"use strict";s.d(a,{SP:function(){return d},dr:function(){return c},mQ:function(){return i},nU:function(){return u}});var t=s(5893),r=s(7294),l=s(681),n=s(3161);let i=l.fC,c=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.aV,{ref:a,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-slate-100 p-1 text-slate-500 dark:bg-slate-800 dark:text-slate-400",s),...r})});c.displayName=l.aV.displayName;let d=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.xz,{ref:a,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-slate-950 data-[state=active]:shadow-sm dark:ring-offset-slate-950 dark:focus-visible:ring-slate-800 dark:data-[state=active]:bg-slate-950 dark:data-[state=active]:text-slate-50",s),...r})});d.displayName=l.xz.displayName;let u=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.VY,{ref:a,className:(0,n.cn)("mt-2 ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2 dark:ring-offset-slate-950 dark:focus-visible:ring-slate-800",s),...r})});u.displayName=l.VY.displayName},4960:function(e,a,s){"use strict";s.d(a,{W:function(){return n}});var t=s(109),r=s(3898);class l{async getUserProfile(e){let a=(0,t.JU)(r.db,"users",e),s=await (0,t.QT)(a);return s.exists()?s.data():null}async updateUserProfile(e,a){let s=(0,t.JU)(r.db,"users",e);await (0,t.r7)(s,{...a,updatedAt:(0,t.Bt)()})}async saveDeal(e,a){let s=(0,t.JU)(r.db,"users",e);await (0,t.r7)(s,{savedDeals:(0,t.vr)(a),updatedAt:(0,t.Bt)()})}async unsaveDeal(e,a){let s=(0,t.JU)(r.db,"users",e);await (0,t.r7)(s,{savedDeals:(0,t.Ab)(a),updatedAt:(0,t.Bt)()})}async getSavedDeals(e){var a;let s=(0,t.JU)(r.db,"users",e),l=(null===(a=(await (0,t.QT)(s)).data())||void 0===a?void 0:a.savedDeals)||[];if(0===l.length)return[];let n=(0,t.hJ)(r.db,"deals"),i=[];for(let e=0;e<l.length;e+=10)i.push(l.slice(e,e+10));let c=[];for(let e of i){let a=(0,t.IO)(n,(0,t.ar)("__name__","in",e)),s=await (0,t.PL)(a);c.push(...s.docs.map(e=>({id:e.id,...e.data()})))}return c}async getPreferences(e){var a;let s=(0,t.JU)(r.db,"users",e);return(null===(a=(await (0,t.QT)(s)).data())||void 0===a?void 0:a.preferences)||{}}async updatePreferences(e,a){let s=(0,t.JU)(r.db,"users",e);await (0,t.r7)(s,{preferences:a,updatedAt:(0,t.Bt)()})}async createInitialUserProfile(e,a){let s=(0,t.JU)(r.db,"users",e);await (0,t.pl)(s,{...a,savedDeals:[],preferences:{},createdAt:(0,t.Bt)(),updatedAt:(0,t.Bt)()})}}let n=new l},6836:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return z}});var t=s(5893),r=s(7294),l=s(1163),n=s(8885),i=s(9889),c=s(354),d=s(8297),u=s(3595),o=s(4960);let f=()=>{let[e,a]=(0,r.useState)(null),[s,t]=(0,r.useState)(!0),[l,i]=(0,r.useState)(null),{user:c}=(0,n.a)();return(0,r.useEffect)(()=>{if(!c){a(null),t(!1);return}(async()=>{try{t(!0);let e=await o.W.getUserProfile(c.uid);a(e)}catch(e){i(e.message)}finally{t(!1)}})()},[c]),{profile:e,loading:s,error:l,updateProfile:async e=>{if(c)try{return await o.W.updateUserProfile(c.uid,e),a(a=>({...a,...e})),!0}catch(e){return i(e.message),!1}}}};var h=s(3736),x=s(8387);let m=(0,x.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),p=(0,x.Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);var v=()=>{var e,a,s;let{profile:l,loading:n,updateProfile:o}=f(),[x,v]=(0,r.useState)(!1),[j,y]=(0,r.useState)({name:"",email:"",phone:"",avatar:""}),N=async e=>{e.preventDefault(),await o(j)&&v(!1)};return n?(0,t.jsx)("div",{children:"Loading profile..."}):(0,t.jsxs)(i.Zb,{className:"w-full max-w-2xl",children:[(0,t.jsx)(i.Ol,{children:(0,t.jsxs)(i.ll,{className:"flex items-center justify-between",children:["Your Profile",!x&&(0,t.jsx)(c.z,{onClick:()=>{y({name:(null==l?void 0:l.name)||"",email:(null==l?void 0:l.email)||"",phone:(null==l?void 0:l.phone)||"",avatar:(null==l?void 0:l.avatar)||""}),v(!0)},variant:"outline",children:"Edit Profile"})]})}),(0,t.jsx)(i.aY,{children:x?(0,t.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(h.qE,{className:"h-20 w-20",children:[(0,t.jsx)(h.F$,{src:j.avatar}),(0,t.jsx)(h.Q5,{children:(null===(e=j.name)||void 0===e?void 0:e.charAt(0))||"U"})]}),(0,t.jsx)(d.I,{placeholder:"Avatar URL",value:j.avatar,onChange:e=>y({...j,avatar:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"name",children:"Name"}),(0,t.jsx)(d.I,{id:"name",value:j.name,onChange:e=>y({...j,name:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"email",children:"Email"}),(0,t.jsx)(d.I,{id:"email",type:"email",value:j.email,onChange:e=>y({...j,email:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"phone",children:"Phone"}),(0,t.jsx)(d.I,{id:"phone",value:j.phone,onChange:e=>y({...j,phone:e.target.value})})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(c.z,{type:"submit",children:"Save Changes"}),(0,t.jsx)(c.z,{type:"button",variant:"outline",onClick:()=>v(!1),children:"Cancel"})]})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(h.qE,{className:"h-20 w-20",children:[(0,t.jsx)(h.F$,{src:null==l?void 0:l.avatar}),(0,t.jsx)(h.Q5,{children:(null==l?void 0:null===(a=l.name)||void 0===a?void 0:a.charAt(0))||"U"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-semibold",children:null==l?void 0:l.name}),(0,t.jsxs)("p",{className:"text-gray-500",children:["Member since ",null==l?void 0:null===(s=l.createdAt)||void 0===s?void 0:s.toDate().toLocaleDateString()]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(m,{className:"h-5 w-5 text-gray-500"}),(0,t.jsx)("span",{children:null==l?void 0:l.email})]}),(null==l?void 0:l.phone)&&(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(p,{className:"h-5 w-5 text-gray-500"}),(0,t.jsx)("span",{children:null==l?void 0:l.phone})]})]})]})})]})};let j=()=>{let[e,a]=(0,r.useState)([]),[s,t]=(0,r.useState)(!0),[l,i]=(0,r.useState)(null),{user:c}=(0,n.a)();return(0,r.useEffect)(()=>{if(!c){a([]),t(!1);return}(async()=>{try{t(!0);let e=await o.W.getSavedDeals(c.uid);a(e)}catch(e){i(e.message)}finally{t(!1)}})()},[c]),{savedDeals:e,loading:s,error:l,saveDeal:async e=>{if(!c)return!1;try{return await o.W.saveDeal(c.uid,e),a(a=>[...a,e]),!0}catch(e){return i(e.message),!1}},unsaveDeal:async e=>{if(!c)return!1;try{return await o.W.unsaveDeal(c.uid,e),a(a=>a.filter(a=>a!==e)),!0}catch(e){return i(e.message),!1}}}};var y=s(3055),N=s(9477),g=s(5666),w=()=>{let{savedDeals:e,loading:a,unsaveDeal:s}=j();return a?(0,t.jsx)("div",{children:"Loading saved deals..."}):(0,t.jsxs)(i.Zb,{className:"w-full",children:[(0,t.jsx)(i.Ol,{children:(0,t.jsx)(i.ll,{children:"Saved Deals"})}),(0,t.jsx)(i.aY,{children:0===e.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(g.BookmarkX,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,t.jsx)("p",{className:"mt-4 text-gray-500",children:"No saved deals yet"})]}):(0,t.jsx)(N.x,{className:"h-[600px] pr-4",children:(0,t.jsx)("div",{className:"grid grid-cols-1 gap-6",children:e.map(e=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(y.Z,{deal:e}),(0,t.jsx)("button",{onClick:()=>s(e.id),className:"absolute top-2 right-2 p-1 bg-white rounded-full shadow hover:bg-gray-100",children:(0,t.jsx)(g.BookmarkX,{className:"h-5 w-5 text-gray-600"})})]},e.id))})})})]})},b=s(6206),k=s(8771),P=s(5360),C=s(7342),S=s(7546),D=s(5320),_="Switch",[E,R]=(0,P.b)(_),[U,A]=E(_),L=r.forwardRef((e,a)=>{let{__scopeSwitch:s,name:l,checked:n,defaultChecked:i,required:c,disabled:d,value:u="on",onCheckedChange:o,form:f,...h}=e,[x,m]=r.useState(null),p=(0,k.e)(a,e=>m(e)),v=r.useRef(!1),j=!x||f||!!x.closest("form"),[y=!1,N]=(0,C.T)({prop:n,defaultProp:i,onChange:o});return(0,t.jsxs)(U,{scope:s,checked:y,disabled:d,children:[(0,t.jsx)(D.WV.button,{type:"button",role:"switch","aria-checked":y,"aria-required":c,"data-state":T(y),"data-disabled":d?"":void 0,disabled:d,value:u,...h,ref:p,onClick:(0,b.M)(e.onClick,e=>{N(e=>!e),j&&(v.current=e.isPropagationStopped(),v.current||e.stopPropagation())})}),j&&(0,t.jsx)(Z,{control:x,bubbles:!v.current,name:l,value:u,checked:y,required:c,disabled:d,form:f,style:{transform:"translateX(-100%)"}})]})});L.displayName=_;var M="SwitchThumb",W=r.forwardRef((e,a)=>{let{__scopeSwitch:s,...r}=e,l=A(M,s);return(0,t.jsx)(D.WV.span,{"data-state":T(l.checked),"data-disabled":l.disabled?"":void 0,...r,ref:a})});W.displayName=M;var Z=e=>{let{control:a,checked:s,bubbles:l=!0,...n}=e,i=r.useRef(null),c=function(e){let a=r.useRef({value:e,previous:e});return r.useMemo(()=>(a.current.value!==e&&(a.current.previous=a.current.value,a.current.value=e),a.current.previous),[e])}(s),d=(0,S.t)(a);return r.useEffect(()=>{let e=i.current,a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(c!==s&&a){let t=new Event("click",{bubbles:l});a.call(e,s),e.dispatchEvent(t)}},[c,s,l]),(0,t.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...n,tabIndex:-1,ref:i,style:{...e.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function T(e){return e?"checked":"unchecked"}var F=s(3161);let J=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(L,{className:(0,F.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...r,ref:a,children:(0,t.jsx)(W,{className:(0,F.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});J.displayName=L.displayName;var O=s(4756);let Y=()=>{let[e,a]=(0,r.useState)({}),[s,t]=(0,r.useState)(!0),[l,i]=(0,r.useState)(null),{user:c}=(0,n.a)();return(0,r.useEffect)(()=>{if(!c){a({}),t(!1);return}(async()=>{try{t(!0);let e=await o.W.getPreferences(c.uid);a(e)}catch(e){i(e.message)}finally{t(!1)}})()},[c]),{preferences:e,loading:s,error:l,updatePreferences:async e=>{if(!c)return!1;try{return await o.W.updatePreferences(c.uid,e),a(a=>({...a,...e})),!0}catch(e){return i(e.message),!1}}}};var q=s(5338);let B=(0,x.Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),I=(0,x.Z)("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);var Q=()=>{let{preferences:e,loading:a,updatePreferences:s}=Y(),[l,n]=(0,r.useState)(e),d=async()=>{await s(l)};return a?(0,t.jsx)("div",{children:"Loading preferences..."}):(0,t.jsxs)(i.Zb,{className:"w-full max-w-2xl",children:[(0,t.jsx)(i.Ol,{children:(0,t.jsx)(i.ll,{children:"Notification Preferences"})}),(0,t.jsxs)(i.aY,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(q.Z,{className:"h-5 w-5"}),(0,t.jsx)(u._,{htmlFor:"price-alerts",children:"Price Drop Alerts"})]}),(0,t.jsx)(J,{id:"price-alerts",checked:l.priceAlerts,onCheckedChange:e=>n(a=>({...a,priceAlerts:e}))})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(m,{className:"h-5 w-5"}),(0,t.jsx)(u._,{htmlFor:"email-notifications",children:"Email Notifications"})]}),(0,t.jsx)(J,{id:"email-notifications",checked:l.emailNotifications,onCheckedChange:e=>n(a=>({...a,emailNotifications:e}))})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(B,{className:"h-5 w-5"}),(0,t.jsx)(u._,{children:"Minimum Discount Percentage"})]}),(0,t.jsx)(O.Slider,{value:[l.minDiscountPercent||0],max:100,step:5,onValueChange:e=>{let[a]=e;return n(e=>({...e,minDiscountPercent:a}))}}),(0,t.jsxs)("div",{className:"text-right text-sm text-gray-500",children:[l.minDiscountPercent,"%"]})]}),(0,t.jsx)("div",{className:"space-y-2",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(I,{className:"h-5 w-5"}),(0,t.jsx)(u._,{children:"Preferred Categories"})]})})]}),(0,t.jsx)(c.z,{onClick:d,className:"w-full",children:"Save Preferences"})]})]})},V=s(529);function z(){let{user:e,loading:a}=(0,n.a)(),s=(0,l.useRouter)();return((0,r.useEffect)(()=>{a||e||s.push("/login")},[e,a,s]),a)?(0,t.jsx)("div",{children:"Loading..."}):e?(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"My Account"}),(0,t.jsxs)(V.mQ,{defaultValue:"profile",className:"space-y-8",children:[(0,t.jsxs)(V.dr,{children:[(0,t.jsx)(V.SP,{value:"profile",children:"Profile"}),(0,t.jsx)(V.SP,{value:"saved",children:"Saved Deals"}),(0,t.jsx)(V.SP,{value:"preferences",children:"Preferences"})]}),(0,t.jsx)(V.nU,{value:"profile",children:(0,t.jsx)(v,{})}),(0,t.jsx)(V.nU,{value:"saved",children:(0,t.jsx)(w,{})}),(0,t.jsx)(V.nU,{value:"preferences",children:(0,t.jsx)(Q,{})})]})]}):null}}},function(e){e.O(0,[133,834,55,774,888,179],function(){return e(e.s=1075)}),_N_E=e.O()}]);